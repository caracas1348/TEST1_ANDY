<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Last-Modified" content="0">
    <meta http-equiv="Cache-Control" content="no-cache, mustrevalidate">
    <meta name="google" value="notranslate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">    
    <meta name="description" content="">
    <meta name="author" content="Visualsat Peru">
    <meta name="generator" content="Jekyll v3.8.6">
    <title>Tabla 5 porque</title>
    <link rel="stylesheet" href="">
    <link rel="stylesheet" href="./css/sass/customize.css?v=3">
</head>
<body>
    
    <table border="2" id="tabla5PorQue">
        <thead>
            <tr>
                <td align="center" colspan="10" rowspan="" headers="" style="background-color: #34559c; color: white;">ACR</td>
            </tr>
            <tr>
                <td align="center" colspan="10" rowspan="" headers="" style="background-color: #34559c; color: white;">An&aacute;lisis Causa Ra&iacute;z</td>
            </tr>
            <tr>
                <td align="center" colspan="10" rowspan="" headers="" style="background-color: #34559c; color: white;">INFORMACI&Oacute;N</td>
            </tr>
        </thead>    
        <tbody id="body5PorQue">
            
        </tbody>

    </table>

    <div id="container">
        
    </div>
    <div id="container2">
        <table id="data-table2">
            <tbody>
                <tr>
                    <td t="s" colspan="10" id="" v="ACR"><span contenteditable="true">ACR</span></td>
                </tr>
                <tr>
                    <td t="s" colspan="10" id="" v="An&aacute;lisis Causa Ra&iacute;z"><span contenteditable="true">An&acute;lisis Causa Ra&iacute;z</span></td>
                </tr>
                <tr>
                    <td t="s" colspan="10" id="" v="Informaci&oacute;n"><span contenteditable="true">Informaci&oacute;n</span></td>
                </tr>
                <tr>
                    <td t="s" colspan="6" id="" v="Tema: Aqui va el Tema"><span contenteditable="true">Tema</span></td>
                    <td t="s" colspan="4" id="" v="Cero P&eacute;rdidas"><span contenteditable="true">Cero P&eacute;rdidas</span></td>
                </tr>
                <tr>
                    <td t="s" colspan="3" id="" v="Equipo/M&aacute;quina: "><span contenteditable="true">Equipo Maquina:</span></td>
                    <td t="s" colspan="3" id="" v="C&oacute;digo SAP Equipo/M&aacute;quina: "><span contenteditable="true">C&oacute;digo SAP Equipo/M&aacute;quina:</span></td>
                    <td t="s" colspan="2" id="" v="1. Cero Defectos"><span contenteditable="true">1. Cero Defectos</span></td>
                    <td t="s" colspan="2" id="" v="3. Cero Aver&iacute;s"><span contenteditable="true">3. Cero Aver&iacute;s</span></td>
                </tr>
                <tr>
                    <td t="s" colspan="3" id="" v="Equipo/M&aacute;quina2"><span contenteditable="true">Equipo Maquina2</span></td>
                    <td t="s" colspan="3" id="" v="C&oacute;digo SAP Equipo/M&aacute;quina2 "><span contenteditable="true">C&oacute;digo SAP Equipo/M&aacute;quina2</span></td>
                    <td t="s" colspan="2" id="" v="2. Cero Accidentes"><span contenteditable="true">2. Cero Accidentes</span></td>
                    <td t="s" colspan="2" id="" v="4. Otra Perdida"><span contenteditable="true">4. Otra Perdida</span></td>
                </tr>
                <tr>
                    <td t="s" colspan="6" id="" v="Zona:"><span contenteditable="true">Zona:</span></td>
                    <td t="s" colspan="2" id="" v="Nombre Persona que Repara"><span contenteditable="true">Nombre Persona que Repara</span></td>
                    <td t="s" colspan="2" id="" v="&Aacute;rea"><span contenteditable="true">&Aacute;rea</span></td>
                </tr>
                <tr>
                    <td t="s" colspan="6" id="" v="Unidades de HYAP"><span contenteditable="true">Unidades de HYAP</span></td>
                    <td t="s" colspan="2" id="" v="Jacqueline Mendoza"><span contenteditable="true">JAcqueline Mendoza</span></td>
                    <td t="s" colspan="2" id="" v="Calidad"><span contenteditable="true">Calidad</span></td>
                </tr>
                <tr>
                    <td t="s" colspan="6" rowspan="2" id="" v="Integrantes An&aacute;lisis"><span contenteditable="true">Integrantes An&aacute;lisis</span></td>
                    <td t="s" colspan="1" id="" v="Inicio Aver&iacute;a"><span contenteditable="true">Inicio Aver&iacute;a</span></td>
                    <td t="s" colspan="1" id="" v="Hora"><span contenteditable="true">Hora</span></td>
                    <td t="s" colspan="1" id="" v="Fin Aver&iacute;a"><span contenteditable="true">Fin Aver&iacute;a</span></td>
                    <td t="s" colspan="1" id="" v="Hora"><span contenteditable="true">Hora</span></td>
                </tr>
                <tr>
                    <td t="s" colspan="1" id="" v="2020-02-02"><span contenteditable="true">2020-02-02</span></td>
                    <td t="s" colspan="1" id="" v="8:30"><span contenteditable="true">8:30</span></td>
                    <td t="s" colspan="1" id="" v="2020-02-15"><span contenteditable="true">2020-02-15</span></td>
                    <td t="s" colspan="1" id="" v="15:30"><span contenteditable="true">15:30</span></td>
                </tr>
                <tr>
                    <td t="s" colspan="6" rowspan="2" id="" v="Marcos Gonzalez, Tony Gonzalez y Andy Vasquez"><span contenteditable="true">Marcos Gonzalez, Tony Gonzalez y Andy Vasquez</span></td>
                    <td t="s" colspan="2" id="" v="Nombre Persona que Reporta"><span contenteditable="true">Nombre Persona que Reporta</span></td>
                    <td t="s" colspan="2" id="" v="&Aacute;rea"><span contenteditable="true">&Aacute;rea</span></td>
                </tr>
                <tr>
                    <td t="s" colspan="2" id="" v="Orly Vila"><span contenteditable="true">Orly Vila</span></td>
                    <td t="s" colspan="2" id="" v="Calidad"><span contenteditable="true">Calidad</span></td>
                </tr>
                <tr>
                    <td t="s" colspan="6" id="" v="Fecha Inicio An&aacute;lisis"><span contenteditable="true">Fecha Inicio An&aacute;lisis</span></td>
                    <td t="s" colspan="2" id="" v="N&uacute;mero de Aviso"><span contenteditable="true">N&uacute;mero de Aviso</span></td>
                    <td t="s" colspan="2" id="" v="N&uacute;mero de Orden"><span contenteditable="true">N&uacute;mero de Orden</span></td>
                </tr>
                <tr>
                    <td t="s" colspan="6" id="" v="2020-02-05"><span contenteditable="true">2020-02-05</span></td>
                    <td t="s" colspan="2" id="" v="NUMAVI-001"><span contenteditable="true">NUMAVI-001</span></td>
                    <td t="s" colspan="2" id="" v="NUMORD-003"><span contenteditable="true">NUMORD-003</span></td>
                </tr>

                
                <tr>
                    <td t="s" colspan="10" id="" v="4W + 1H - Definición del Problema"><span contenteditable="true">4W + 1H - Definición del Problema</span></td>
                </tr>
                <tr>
                    <td t="s" colspan="3" id="" v="¿Qué? ¿Qué hace evidente el problema? ¿En qué se manifiesta el inconveniente?"><span contenteditable="true">¿Qué? ¿Qué hace evidente el problema? ¿En qué se manifiesta el inconveniente?</span></td>
                    <td t="s" colspan="7" id="" v="Efluente se envia al emisor a pesar de que incumple los LMP."><span contenteditable="true">Efluente se envia al emisor a pesar de que incumple los LMP.</span></td>
                </tr>
                <tr>
                    <td t="s" colspan="3" id="" v="¿D&oacute;nde?"><span contenteditable="true">¿D&oacute;nde?</span></td>
                    <td t="s" colspan="7" id="" v="Sistema de tratamiento de efluentes pesqueros."><span contenteditable="true">Sistema de tratamiento de efluentes pesqueros.</span></td>
                </tr>
                <tr>
                    <td t="s" colspan="3" id="" v="¿Cu&aacute;ndo?"><span contenteditable="true">¿Cu&aacute;ndo?</span></td>
                    <td t="s" colspan="7" id="" v="Sistema de tratamiento de efluentes pesqueros."><span contenteditable="true">Durante la operación.</span></td>
                </tr>
                <tr>
                    <td t="s" colspan="3" id="" v="¿Cu&aacute;ndo?"><span contenteditable="true">¿C&oacute;mo?</span></td>
                    <td t="s" colspan="7" id="" v="Sistema de tratamiento de efluentes pesqueros."><span contenteditable="true">Se trabaja en modo manual.</span></td>
                </tr>
                <tr>
                    <td t="s" colspan="3" id="" v="¿Cu&aacute;ndo?"><span contenteditable="true">¿Cu&aacute;l?</span></td>
                    <td t="s" colspan="7" id="" v="Sistema de tratamiento de efluentes pesqueros."><span contenteditable="true">En el último diagnóstico a los sistemas de tratamiento de efluentes, todas las unidades con excepción de la Unidad de Callao, se encontraron operando en modo manual.</span></td>
                </tr>
                <tr>
                    <td t="s" colspan="10" id="" v="Descripción del problema: Sistemas de tratamiento de efluentes operan manualmente, y se envían al emisor a pesar de que estén incumpliendo los LMP. "><span contenteditable="true">Descripción del problema: Sistemas de tratamiento de efluentes operan manualmente, y se envían al emisor a pesar de que estén incumpliendo los LMP. </span></td>
                </tr>


                <tr>
                    <td t="s" colspan="10" id="" v="An&aacute;lisis del Problema (5 Por qu&eacute;)"><span contenteditable="true">An&aacute;lisis del Problema (5 Por qu&eacute;)</span></td>
                </tr>
                <tr>
                    <td t="s" colspan="2" id="" v="1er. PorQue"><span contenteditable="true">1er. PorQue</span></td>
                    <td t="s" colspan="2" id="" v="2do. PorQue"><span contenteditable="true">2do. PorQue</span></td>
                    <td t="s" colspan="2" id="" v="3er. PorQue"><span contenteditable="true">3er. PorQue</span></td>
                    <td t="s" colspan="2" id="" v="4to. PorQue"><span contenteditable="true">4to. PorQue</span></td>
                    <td t="s" colspan="2" id="" v="5to. PorQue"><span contenteditable="true">5to. PorQue</span></td>
                </tr>

                
                <tr>
                    <td t="s" colspan="5" rowspan="2" id="" v="Causas"><span contenteditable="true">Causas</span></td>
                    <td t="s" colspan="5" id="" v="5 Medidas para cero fallas"><span contenteditable="true">5 Medidas para cero fallas</span></td>
                </tr>
                <tr>
                    <td t="s" colspan="1" id="" v="Establecer Condiciones B&aacute;s"><span contenteditable="true">Establecer Condiciones B&aacute;s</span></td>
                    <td t="s" colspan="1" id="" v="Restauraci&oacute;n de Deterioro"><span contenteditable="true">Restauraci&oacute;n de Deterioro</span></td>
                    <td t="s" colspan="1" id="" v="Operaci&oacute;n Correcta"><span contenteditable="true">Operaci&oacute;n Correcta</span></td>
                    <td t="s" colspan="1" id="" v="Mejora Puntos de Dise&ntilde;o"><span contenteditable="true">Mejora Puntos de Dise&ntilde;o</span></td>
                    <td t="s" colspan="1" id="" v="Entrenamiento"><span contenteditable="true">Entrenamiento</span></td>
                </tr>

                <tr>
                    <td t="s" colspan="10" id="" v="Plan de Acci&oacute;n"><span contenteditable="true">Plan de Acci&oacute;n</span></td>
                </tr>



            </tbody>
        </table>
    </div>

</body>
</html>

<script src="js/jquery-3.4.1.js"></script> 
<script src="./modules/sheetjs/xlsx.full.min.js"></script>
<script src="./modules/sheetjs/FileSaver.min.js"></script>
<script src="./modules/sheetjs/tableexport.min.js"></script>

<script>
    var count1PorQue = 0
    var Code = "#356926"
        
    //-------------------------('document').ready-------------------------------
    $('document').ready(function()
    {

        let count1=count2=count3=count4=count5=0


        // 5 2to-porque de 1 1to-porque
        /*for (var i1 = 0; i1 < 5; i1++) 
        {
            $("#body5PorQue").append(`<tr><td rowspan="781" nivel="1" id="1pq_${i1}" >${i1}</td></tr>`)
            // 5 2to-porque de 1 1to-porque
            for (var i2 = 0; i2 < 5; i2++) 
            {
                $("#body5PorQue").append(`<tr><td rowspan="156" nivel="2" id="2pq_${i1}${i2}" >${i1}-${i2}</td></tr>`)    
                // 5 3to-porque de 1 2to-porque
                for (var i3 = 0; i3 < 5; i3++) 
                {
                    $("#body5PorQue").append(`<tr><td rowspan="31" nivel="3" id="3pq_${i1}${i2}${i3}" >${i1}-${i2}-${i3}</td></tr>`)
                    // 5 4to-porque de 1 3to-porque
                    for (var i4 = 0; i4 < 5; i4++) 
                    {
                        $("#body5PorQue").append(`<tr><td rowspan="6" nivel="4" id="4pq_${i1}${i2}${i3}${i4}" >${i1}-${i2}-${i3}-${i4}</td></tr>`)

                        // 5 5to-porque de 1 4to-porque
                        for (var i5 = 0; i5 < 5; i5++) 
                        {
                            $("#body5PorQue").append(`<tr><td rowspan="1" nivel="5" id="5pq_${i1}${i2}${i3}${i4}${i5}" >${i1}-${i2}-${i3}-${i4}-${i5}</td></tr>`)
                        }
                    }
                }
            }
        }//*/

        //fnSp4AgregarPorque(1,count1PorQue,0,0,0,0,"")
        //count1PorQue++
        // fnSp4AgregarPorque(1,count1PorQue,0,0,0,0,"")
        // fnSp4AgregarPorque(1,count1PorQue,0,0,0,0,"")
        // fnSp4AgregarPorque(1,count1PorQue,0,0,0,0,"")
        // fnSp4AgregarPorque(1,count1PorQue,0,0,0,0,"")
        /*const $tabla = $("#tabla5PorQue");
        let tableExport = new TableExport($tabla, {
            exportButtons: false, // No queremos botones
            filename: "AnalisisCausaRaiz", //Nombre del archivo de Excel
            sheetname: "ACR", //Título de la hoja
        });
        let datos = tableExport.getExportData();
        console.warn("datos",datos)
        console.warn("datos.tabla5PorQue",datos.tabla5PorQue)
        console.warn("datos.tabla5PorQue.xlsx",datos.tabla5PorQue.xlsx)
        let preferenciasDocumento = datos.tabla5PorQue.xlsx;
        tableExport.export2file(preferenciasDocumento.data, preferenciasDocumento.mimeType, preferenciasDocumento.filename, preferenciasDocumento.fileExtension, preferenciasDocumento.merges, preferenciasDocumento.RTL, preferenciasDocumento.sheetname);//*/

        
    });
    //-------------------------('document').ready-------------------------------



    /////////////////EJEMPLO MARCOS
    /**
     *
     * @param objArray
     */
    /*function convertToCSV(objArray) 
    {
        const array = typeof objArray != "object" ? JSON.parse(objArray) : objArray;
        let str = "";
        for (let i = 0; i < array.length; i++) 
        {
            let line = "";
            for (let index in array[i]) 
            {
                if (line != "") line += ",";
                line += array[i][index];
            }
            str += line + "\r\n";
        }
        return str;
    }//*/

    /**
     *
     * @param headers
     * @param items
     * @param fileName
     */
    /*function exportCSVFile(headers, items, fileName) 
    {
        if (headers) 
        {
            items.unshift(headers);
        }
        
        const jsonObject = items;//JSON.stringify(items);
        const csv = convertToCSV(jsonObject);
        const exportName = fileName + ".csv" || "export.csv";

        var cCode,
        bArr = [];
        bArr.push(255, 254);
        for (var i = 0; i < csv.length; ++i) 
        {
            cCode = csv.charCodeAt(i);
            bArr.push(cCode & 0xff);
            bArr.push((cCode / 256) >>> 0);
        }

        //const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
        const blob = new Blob([new Uint8Array(bArr)], { type: "text/csv;charset=UTF-16LE;" });
        
        if (navigator.msSaveBlob) 
        {
            navigator.msSaveBlob(blob, exportName);
        } 
        else 
        {
            const link = document.createElement("a");
            if (link.download !== undefined) 
            {
                const url = URL.createObjectURL(blob);
               link.setAttribute("href", url);
               link.setAttribute("download", exportName);
               link.style.visibility = "hidden";
               document.body.appendChild(link);
               link.click();
               document.body.removeChild(link);
            }
        }
    }

    

    const headers = 
    {
        id: 'Identificador',
        nombre: 'Nombre'
    };

    const data = [
     { id: 1, nombre: 'John Doe' },
     { id: 2, nombre: 'Juan' },
     { id: 3, nombre: 'Samanta' }
    ];

    exportCSVFile(headers, data, 'nombres');//*/
    /////////////////EJEMPLO MARCOS
    
    

    ////////// EJEMPLO SHEETJS
    /*var wb = XLSX.utils.book_new();
    wb.Props = {
            Title: "SheetJS Tutorial",
            Subject: "Test",
            Author: "SIGTASA",
            CreatedDate: new Date()
    };

    wb.SheetNames.push("Test Sheet");
    var ws_data = [
        ['','','','','ACR'],
        ['','','','','ANALISIS CAUSA RAIZ'],
        ['','','','','INFORMACION']
    ];
    var ws = XLSX.utils.aoa_to_sheet(ws_data);
    wb.Sheets["Test Sheet"] = ws;

    var wbout = XLSX.write(wb, {bookType:'xlsx',  type: 'binary'});
    function s2ab(s) 
    {
        var buf = new ArrayBuffer(s.length);
        var view = new Uint8Array(buf);
        for (var i=0; i<s.length; i++) view[i] = s.charCodeAt(i) & 0xFF;
            
        return buf;       
    }

    console.table(wbout)

    saveAs(new Blob([s2ab(wbout)],{type:"application/octet-stream"}), 'test.xlsx');//*/
    ////////// EJEMPLO SHEETJS
    

    ////////// EJEMPLO SHEETJS exportar table
    function doit(type, fn, dl) {
        var elt = document.getElementById('data-table2');
        var wb = XLSX.utils.table_to_book(elt, {sheet:"ACR-HAI001"});
        
        return dl ?
            XLSX.write(wb, {bookType:type, bookSST:true, type: 'base64'}) :
            XLSX.writeFile(wb, fn || ('SheetJSTableExport.' + (type || 'xlsx')));
    }
    /* initial table */
    var aoa = [
        ["This",   "is",     "a",    "Test"],
        ["வணக்கம்", "สวัสดี", "你好", "가지마"],
        [1,        2,        3,      4],
        ["Click",  "to",     "edit", "cells"]
    ];
    var ws = XLSX.utils.aoa_to_sheet(aoa);
    var html_string = XLSX.utils.sheet_to_html(ws, { id: "data-table", editable: true });
    document.getElementById("container").innerHTML = html_string;

    doit('xlsx');

    function tableau(pid, iid, fmt, ofile) {
        if(typeof Downloadify !== 'undefined') Downloadify.create(pid,{
                swf: 'downloadify.swf',
                downloadImage: 'download.png',
                width: 100,
                height: 30,
                filename: ofile, data: function() { return doit(fmt, ofile, true); },
                transparent: false,
                append: false,
                dataType: 'base64',
                onComplete: function(){ alert('Your File Has Been Saved!'); },
                onCancel: function(){ alert('You have cancelled the saving of this file.'); },
                onError: function(){ alert('You must put something in the File Contents or there will be nothing to save!'); }
        }); else document.getElementById(pid).innerHTML = "";
    }
    tableau('biff8btn', 'xportbiff8', 'biff8', 'SheetJSTableExport.xls');
    tableau('odsbtn',   'xportods',   'ods',   'SheetJSTableExport.ods');
    tableau('fodsbtn',  'xportfods',  'fods',  'SheetJSTableExport.fods');
    tableau('xlmlbtn',  'xportxlml',  'xlml',  'SheetJSTableExport.xml');
    tableau('xlsbbtn',  'xportxlsb',  'xlsb',  'SheetJSTableExport.xlsb');
    tableau('xlsxbtn',  'xportxlsx',  'xlsx',  'SheetJSTableExport.xlsx');

    var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-36810333-1']);
      _gaq.push(['_setDomainName', 'sheetjs.com']);
      _gaq.push(['_setAllowLinker', true]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    ////////// EJEMPLO SHEETJS exportar table

    

    var fnSp4AgregarPorque = function(Nivel,pq1,pq2,pq3,pq4,pq5,ver)
    {
        if(count1PorQue<5)
        {
            let btnAgregar = (count1PorQue==0)
                ? `<button class="grid-drop__btn" ${ver} id="newPorQueHA" onmouseup="fnSp4AgregarPorque(${count1PorQue},${pq1},${pq2},${pq3},${pq4},${pq5},${ver})">+ Agregar Nuevo</button>`
                : `<button class="grid-drop__btn" ${ver} disabled readonly>...</button>`

            let btnAgregarHijo = (Nivel<5)
                ? `<button class="grid-drop__add" onmouseup="fnSp4CrearPorqueHijo(${Nivel},0,${count1PorQue},${pq2},${pq3},${pq4},${pq5})" style="background-image: url('images/triangulo-btn.svg');">+</button>`
                : `<button class="grid-drop__add" style="background-image: url('images/triangulo-btn.svg2');"></button>`

            console.warn("btnAgregar",btnAgregar)
            console.warn("btnAgregarHijo",btnAgregarHijo)

            let pq1Id = "_"+count1PorQue+"0000"
            let gdId  = `gd${Nivel}_${pq1}${pq2}${pq3}${pq4}${pq5}`
            let pd    = "mr-1"

            let content = `
                <div class="grid-drop__body ${pd} ${gdId}">
                    ${btnAgregar}

                     <div class="grid-drop__drap">
                        <div class="grid-drop__contain-main">
                            ${btnAgregarHijo}

                            <div class="grid-drop__note" id="pq${pq1Id}"> 
                                <button class="grid-drop__tap" style="border-right-color:${Code}"></button>
                                <div class="question d-column-l">
                                    <label class="text-gray" for="">Escribir Pregunta </label>
                                    <textarea ${ver} name="pr${pq1Id}" id="pr${pq1Id}" onkeyup="fnSp4SavePregunta(${count1PorQue},0,0,0,0,1,0,this)" rows="2" style="resize: none;" class="question-input" placeholder="..."></textarea>
                                </div>
                                <div class="question d-column-l bt-lightgray">
                                    <label for="" class="text-gray">Escribir Respuesta </label>
                                    <textarea ${ver} name="re${pq1Id}" id="re${pq1Id}" onkeyup="fnSp4SaveRespuesta(${count1PorQue},0,0,0,0,1,0,this)" rows="2" style="resize: none;" class="question-input" placeholder="..."></textarea>
                                </div>

                            </div>

                        </div>
                    </div>

                </div>
            `

            console.warn("content",content)
            //1pq_
            $(`#${Nivel}pq_${count1PorQue}`).append(`
                ${content}
            `);

            count1PorQue++
        }
        else
            alert("No puedes crear mas primer porque")
    }



      
</script>
